<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投資理財測驗</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        // Firebase 初始化
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "https://pccujrjz-f0c56-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
    </script>
</head>
<body>
    <h1>投資理財測驗</h1>
    <div id="question-container"></div>
    <button onclick="submitFeedback()">提交回饋</button>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const level = urlParams.get('level');

        // 題庫資料：按難度等級分組
        const questions = {
            3: [ // 老手級
                {
                    "question": "1. 什麼是資本利得稅？",
                    "options": ["A. 資產增值所需支付的稅", "B. 只限於固定資產", "C. 無需支付", "D. 僅針對個人"],
                    "correct": 0,
                    "explanation": "資本利得稅是對資產（如股票、房產等）增值後的利潤徵收的稅款。"
                },
                {
                    "question": "2. 如何評估股票的內在價值？",
                    "options": ["A. 通過基本面分析", "B. 僅依賴市場趨勢", "C. 只考慮技術指標", "D. 無需關心"],
                    "correct": 1,
                    "explanation": "股票的內在價值通常通過基本面分析來評估，這包括公司財務狀況、行業前景等因素。"
                },
                {
                    "question": "3. 如何設計有效的資產配置策略？",
                    "options": ["A. 根據風險承受能力和投資目標", "B. 隨意選擇資產", "C. 僅考慮收益", "D. 無需調查"],
                    "correct": 2,
                    "explanation": "資產配置策略應根據投資者的風險承受能力和投資目標來設計，以達到最佳的風險回報比。"
                },
                {
                    "question": "4. 在考慮房地產投資時，最重要的因素是什麼？",
                    "options": ["A. 地理位置和市場趨勢", "B. 僅限於價格", "C. 只考慮租金", "D. 無需考慮"],
                    "correct": 3,
                    "explanation": "房地產投資最重要的是地理位置和市場趨勢，這直接影響資產的增值潛力。"
                },
                {
                    "question": "5. 什麼是對沖策略？",
                    "options": ["A. 減少投資風險的手段", "B. 僅限於股票", "C. 只考慮高風險投資", "D. 無需使用策略"],
                    "correct": 1,
                    "explanation": "對沖策略是一種通過投資於與主投資風險相反的資產來減少風險的手段。"
                },
                {
                    "question": "6. 投資基金的主要優勢是什麼？",
                    "options": ["A. 專業管理和風險分散", "B. 只關心回報", "C. 僅限於高額投資", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "投資基金的優勢包括專業管理和風險分散，使得投資者能夠減少風險，並提高回報的穩定性。"
                },
                {
                    "question": "7. 在金融市場中，什麼是流動性？",
                    "options": ["A. 資產轉換為現金的難易程度", "B. 僅限於股票", "C. 只考慮短期投資", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "流動性是指資產轉換為現金的難易程度，流動性越高，資產越容易變現。"
                },
                {
                    "question": "8. 什麼是合併與收購？",
                    "options": ["A. 企業之間的合併或收購交易", "B. 僅限於小型企業", "C. 只關心股票", "D. 無需考慮"],
                    "correct": 2,
                    "explanation": "合併與收購是指企業之間的合併或收購交易，目的是擴展規模、增加市場份額或實現資源整合。"
                },
                {
                    "question": "9. 如何評估一個企業的財務健康狀況？",
                    "options": ["A. 通過財務報表分析", "B. 僅依賴市場反應", "C. 只考慮短期回報", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "企業的財務健康狀況可以通過其財務報表進行分析，包括收入、利潤、負債等指標。"
                },
                {
                    "question": "10. 什麼是共同基金的費用比率？",
                    "options": ["A. 投資者需支付的管理費用比例", "B. 只關心收益", "C. 僅針對固定基金", "D. 無需考慮"],
                    "correct": 3,
                    "explanation": "共同基金的費用比率指投資者需要支付的管理費用，通常以年度費用的百分比表示。"
                },
                {
                    "question": "11. 如果想在國際市場投資，應該考慮什麼？",
                    "options": ["A. 當地市場的法律和風險", "B. 僅依賴市場趨勢", "C. 只考慮短期收益", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "國際投資需考慮當地市場的法律、風險及經濟環境等因素，以確保投資的安全和收益。"
                },
                {
                    "question": "12. 如何評估一個投資的風險與回報？",
                    "options": ["A. 通過歷史數據和市場分析", "B. 只依賴直覺", "C. 僅考慮表面現象", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "風險與回報的評估應該通過歷史數據、行業趨勢和市場分析來進行。"
                },
                {
                    "question": "13. 什麼是外匯交易？",
                    "options": ["A. 交易不同國家的貨幣", "B. 只限於股票", "C. 僅針對商品", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "外匯交易是指不同國家貨幣之間的交易，並且是全球最大的金融市場。"
                },
                {
                    "question": "14. 在選擇退休計劃時，應該考慮什麼？",
                    "options": ["A. 長期回報和風險", "B. 僅限於短期收益", "C. 只考慮當前收入", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "選擇退休計劃時，應該考慮長期回報與風險，這將影響到退休後的生活質量。"
                },
                {
                    "question": "15. 什麼是金融衍生品？",
                    "options": ["A. 其價值基於其他資產的金融工具", "B. 僅限於股票和債券", "C. 無需考慮", "D. 只有大企業使用"],
                    "correct": 0,
                    "explanation": "金融衍生品是指其價值基於其他資產（如股票、債券等）的金融工具，常用於對沖或投機。"
                },
                {
                    "question": "16. 在進行企業評估時，最重要的指標是什麼？",
                    "options": ["A. 盈利能力和現金流", "B. 只關心市場份額", "C. 僅考慮負債", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "企業評估的關鍵指標是盈利能力、現金流、資本結構等，這些反映了企業的財務狀況和未來發展潛力。"
                },
                {
                    "question": "17. 在投資中，什麼是市場心理？",
                    "options": ["A. 投資者情緒對市場的影響", "B. 只關心經濟數據", "C. 僅限於技術指標", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "市場心理指的是投資者的情緒如何影響市場價格的波動，常見的如過度樂觀或悲觀情緒。"
                },
                {
                    "question": "18. 如何選擇一個好的股票？",
                    "options": ["A. 通過基本面分析和技術分析相結合", "B. 只考慮股價的變化", "C. 僅依賴專家意見", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "選擇股票時，應結合基本面分析（如財報、公司前景等）和技術分析（如趨勢線、指標等）來做出決策。"
                },
                {
                    "question": "19. 什麼是市場調查？",
                    "options": ["A. 收集和分析市場資訊的過程", "B. 只限於競爭對手分析", "C. 只依賴經濟指標", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "市場調查是指收集和分析有關市場需求、競爭狀況、消費者行為等資訊的過程。"
                },
                {
                    "question": "20. 什麼是杠桿效應？",
                    "options": ["A. 利用借款放大投資回報", "B. 只限於股票市場", "C. 只考慮短期回報", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "杠桿效應指通過借款來放大投資回報，但同時也會增加風險。"
                },
                {
                    "question": "21. 什麼是退休金計劃？",
                    "options": ["A. 為退休生活儲備的長期投資計劃", "B. 只限於政府提供", "C. 僅考慮短期回報", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "退休金計劃是一種長期投資計劃，用於為退休後的生活提供資金支持，通常包括定期存款、基金等方式。"
                },
                {
                    "question": "22. 在進行投資時，為什麼要進行風險分散？",
                    "options": ["A. 減少某一項投資失敗的影響", "B. 增加收益", "C. 只限於大額投資", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "風險分散能夠減少單一投資失敗對整體投資組合的影響，從而降低風險，保護投資者的資本。"
                },
                {
                    "question": "23. 什麼是負債比率？",
                    "options": ["A. 表示公司負債相對於資本的比例", "B. 只限於短期負債", "C. 僅考慮貸款", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "負債比率是衡量公司負債水平的一個財務指標，反映了公司資本結構中的負債佔比。"
                },
                {
                    "question": "24. 投資中，什麼是多元化投資策略？",
                    "options": ["A. 投資於不同類型的資產以分散風險", "B. 僅投資於股票市場", "C. 只依賴一種資產", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "多元化投資策略是指將資金分散投資於不同類型的資產（如股票、債券、房地產等），以降低單一市場波動的風險。"
                },
                {
                    "question": "25. 什麼是增長型投資策略？",
                    "options": ["A. 尋求資本增值而非當前收益", "B. 只關心固定收益", "C. 只依賴安全性", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "增長型投資策略主要目的是尋求資本增值，通常選擇具有高成長潛力的股票或其他資產，而非以當前收益為主。"
                },
                {
                    "question": "26. 什麼是貨幣市場基金？",
                    "options": ["A. 主要投資於短期、低風險的金融工具", "B. 只限於國內市場", "C. 僅涉及長期投資", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "貨幣市場基金主要投資於短期、低風險的金融工具，如國庫券、商業票據等，提供較為穩定的回報。"
                },
                {
                    "question": "27. 什麼是債券？",
                    "options": ["A. 政府或企業發行的債務證券", "B. 僅限於短期工具", "C. 只關心股票市場", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "債券是政府或企業為籌集資金所發行的債務證券，投資者通過購買債券實際上是在貸款給發行者，並獲得定期利息。"
                },
                {
                    "question": "28. 什麼是技術分析？",
                    "options": ["A. 通過價格和交易量的歷史數據來預測市場趨勢", "B. 只關心公司的基本面", "C. 僅依賴市場消息", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "技術分析是通過研究價格和交易量的歷史數據，來預測未來的市場走勢，通常用於股票或外匯市場的分析。"
                },
                {
                    "question": "29. 什麼是貨幣政策？",
                    "options": ["A. 政府對貨幣供應量和利率的控制", "B. 只限於經濟學者關心", "C. 僅涉及外匯市場", "D. 無需關心"],
                    "correct": 0,
                    "explanation": "貨幣政策是政府或中央銀行通過調節貨幣供應量和利率來影響經濟活動的政策，目的是保持物價穩定，促進經濟增長。"
                },
                {
                    "question": "30. 什麼是財務自由？",
                    "options": ["A. 足夠的資產和收入支持無需工作", "B. 只考慮短期回報", "C. 僅依賴遺產", "D. 無需考慮"],
                    "correct": 0,
                    "explanation": "財務自由是指擁有足夠的資產和收入，能夠支持生活而不需要依賴工作或外部收入來源。"
                }
            ]
        };

        let currentQuestion = 0;
        let score = 0;
        let feedback = [];

        function loadQuestion() {
            const questionData = questions[level][currentQuestion];
            if (!questionData) {
                document.getElementById('question-container').innerHTML = `測驗完成！正確率：${Math.round((score / questions[level].length) * 100)}%`;
                return;
            }

            const container = document.getElementById('question-container');
            container.innerHTML = `
                        <p>${questionData.question}</p>
                        ${questionData.options.map((option, index) => `
                            <button onclick="checkAnswer(${index})">${option}</button>
                        `).join('')}
                    `;
        }

        function checkAnswer(selected) {
            const questionData = questions[level][currentQuestion];
            if (selected === questionData.correct) {
                score++;
                alert("正確！");
            } else {
                alert(`錯誤！正確答案是：${questionData.options[questionData.correct]}\n解析：${questionData.explanation}`);

                // 僅在答錯時顯示「此解析是否對您有幫助」的確認視窗
                const isHelpful = confirm("此解析對您是否有幫助？（按確定表示有，取消表示無）");
                feedback.push({ question: questionData.question, helpful: isHelpful });
            }

            currentQuestion++;
            loadQuestion();
        }

        function submitFeedback() {
            const statsRef = db.ref('quizStats');
            statsRef.once('value').then((snapshot) => {
                const stats = snapshot.val() || { participants: 0, totalScore: 0, helpfulCount: 0, totalErrors: 0 };

                // 計算錯誤題數中被標記為「有幫助」的題數
                const helpfulErrors = feedback.filter(f => !f.correct && f.helpful).length;
                const totalErrors = feedback.filter(f => !f.correct).length;

                stats.participants += 1;
                stats.totalScore += score;
                stats.totalErrors += totalErrors;
                stats.helpfulCount += helpfulErrors;

                statsRef.set(stats);
                alert("感謝您的參與！測驗結果已提交。");
                window.location.href = "index.html";
            });
        }


        loadQuestion();
    </script>
</body>
</html>
